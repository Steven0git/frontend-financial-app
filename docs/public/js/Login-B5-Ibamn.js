import{g,r as o,j as e}from"./index-C1pkt5FT.js";import{d as h,F as y,I as m,B as b,A as j,g as k,a as w}from"./Alert-Tgx7xg68.js";import{M as v}from"./MainLayout-w59ccZPq.js";var S=h;const N=g(S),I=()=>{const[r,a]=o.useState(null),[n,i]=o.useState(!1),[l,d]=o.useState(0),u=async c=>{if(c.preventDefault(),l>=3){a({type:"error",title:"Too many attempts!",message:"Please wait a few minutes and try again."}),document.querySelector("form#form").classList.add("hidden");return}navigator.cookieEnabled?console.info("Cookies are enabled. Your login request is being processed."):console.warn("This website uses cookies to ensure security and functionality. Please enable cookies in your browser settings, at least for this site, or for 'same-origin' requests."),d(l+1),i(!0);const f=new FormData(c.target),p=await k("csrftoken");let x="55d1100248df4fc0b700d03add1cc66f1eddb3bb";try{const s=await w.post("/login/",f,{withCredentials:!0,headers:{"x-csrftoken":p,Authorization:`Token ${x}`,"Content-Type":"multipart/form-data",Vary:"Accept","WWW-Authenticate":"Token"}}),t=JSON.parse(s.data);a({type:"success",title:`${s.status} - ${s.statusText}`,message:`${t.info.message},`||"Hmm no feedback! from server",href:t.info.redirect}),localStorage.getItem("token-financial-app-2024")??localStorage.removeItem("token-financial-app-2024"),t.token?localStorage.setItem("token-financial-app-2024",JSON.stringify(t.token)):location.reload(),document.querySelector("form#form").classList.add("hidden")}catch(s){console.error("Error submitting form:",s.response),a({type:"error",title:`${s.response.status} - ${s.response.statusText}`,message:s.response.data||"Server didn't send message back!"})}finally{setTimeout(()=>{i(!1)},1500)}};return e.jsx(v,{children:e.jsxs(y,{title:"Signin to your Account",children:[e.jsxs("form",{className:"space-y-4",onSubmit:u,method:"post",id:"form",children:[e.jsx(N,{}),e.jsx("hr",{className:"opacity-40"}),e.jsxs("div",{className:"flex flex-col flex-wrap space-y-2",children:[e.jsx(m,{type:"email",id:"email",name:"Your Email",placeholder:"Input your email...",icon:"email",maxlength:"25"}),e.jsx(m,{type:"password",id:"password",name:"Password",placeholder:"Your Password...",icon:"passkey",maxlength:"35"})]}),e.jsx("div",{className:"flex justify-center justify-items-center overflow-x-hidden p-0",children:e.jsx(b,{name:"Login",icon:"add",type:"submit",className:"w-full max-w-full"})}),e.jsx("hr",{className:"my-2 opacity-40"}),e.jsxs("span",{className:"roboto-mono flex justify-end opacity-80 transition-all hover:opacity-100",children:["Does't have an account?",e.jsx("a",{href:"/register",className:"link link-info ml-2 text-blue-300 underline opacity-100 hover:text-blue-600 hover:underline",children:"Register"})]})]}),e.jsxs("div",{className:"px-2 py-4",children:[n&&e.jsxs("div",{id:"loading-submit",className:"mb-4 mt-2 flex items-center border-t-2 border-blue-300",role:"alert",children:[e.jsx("span",{className:"material-symbols-outlined h-4 w-4 flex-shrink-0",children:"pending"}),e.jsx("div",{className:"roboto-mono ms-3 text-sm font-medium",children:"Sending the data to server...."})]}),!n&&r&&e.jsx(j,{...r})]})]})})};export{I as default};
